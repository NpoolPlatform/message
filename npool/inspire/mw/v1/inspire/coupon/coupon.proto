syntax = "proto3";

package inspire.middleware.inspire1.coupon.v1;

option go_package = "github.com/NpoolPlatform/message/npool/inspire/mw/v1/inspire/coupon";

import "npool/inspire/mgr/v1/inspire/coupon/allocated/allocated.proto";
import "npool/npool.proto";

// Service Name
service Middleware {
    rpc GetCoupon      (GetCouponRequest)      returns (GetCouponResponse)      {}
    rpc GetManyCoupons (GetManyCouponsRequest) returns (GetManyCouponsResponse) {}
    rpc GetCoupons     (GetCouponsRequest)     returns (GetCouponsResponse)     {}
    rpc GetCouponOnly  (GetCouponOnlyRequest)  returns (GetCouponOnlyResponse)  {}
}

message Conds {
    optional npool.v1.StringVal ID       = 10;
    optional npool.v1.StringVal UserID   = 20;
    optional npool.v1.StringVal AppID    = 30;
    optional npool.v1.Uint32Val Type     = 31;
    optional npool.v1.StringVal CouponID = 40;
}

message Coupon {
    // @inject_tag: sql:"id"
    string     ID              = 10;
    inspire.manager.inspire.coupon.allocated.v1.CouponType Type = 20;
    // @inject_tag: sql:"value"
    string     Value           = 30;
    string     ThresholdAmount = 40;
    // @inject_tag: sql:"start"
    uint32     StartAt         = 50;
    // @inject_tag: sql:"duration_days"
    uint32     DurationDays    = 60;
    uint32     EndAt           = 70;
    // @inject_tag: sql:"coupon_id"
    string     CouponID        = 71;
    // @inject_tag: sql:"name"
    string     Name            = 80;
    // @inject_tag: sql:"message"
    string     Message         = 90;
    bool       Expired         = 100;
    bool       Valid           = 110;
    // @inject_tag: sql:"create_at"
    uint32     CreatedAt       = 120;
    // @inject_tag: sql:"app_id"
    string     AppID           = 130;
    // @inject_tag: sql:"user_id"
    string     UserID          = 140;
}

message GetCouponRequest {
    string                                                 ID   = 10;
    inspire.manager.inspire.coupon.allocated.v1.CouponType Type = 20;
}

message GetCouponResponse {
    Coupon Info = 10;
}

message GetManyCouponsRequest {
    repeated string                                        IDs  = 10;
    inspire.manager.inspire.coupon.allocated.v1.CouponType Type = 20;
}

message GetManyCouponsResponse {
    repeated Coupon Infos = 10;
}

message GetCouponsRequest {
    inspire.manager.inspire.coupon.allocated.v1.CouponType Type = 10;
    Conds  Conds  = 20;
    uint32 Offset = 30;
    uint32 Limit  = 40;
}

message GetCouponsResponse {
    repeated Coupon Infos = 10;
    uint32          Total = 20;
}

message GetCouponOnlyRequest {
    inspire.manager.inspire.coupon.allocated.v1.CouponType Type = 10;
    Conds Conds = 20;
}

message GetCouponOnlyResponse {
    Coupon Info = 10;
}
