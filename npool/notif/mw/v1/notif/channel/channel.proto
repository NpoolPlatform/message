syntax = "proto3";

package notif.middleware.notif.channel.v1;

option go_package = "github.com/NpoolPlatform/message/npool/notif/mw/v1/notif/channel";

import "npool/basetypes/v1/channel.proto";
import "npool/basetypes/v1/usedfor.proto";
import "npool/basetypes/v1/conds.proto";

// Service Name
service Middleware {
    rpc GetChannels       (GetChannelsRequest)       returns (GetChannelsResponse)       {}
    rpc GetChannelOnly    (GetChannelOnlyRequest)    returns (GetChannelOnlyResponse)    {}
    rpc CreateChannel     (CreateChannelRequest)     returns (CreateChannelResponse)     {}
    rpc CreateChannels    (CreateChannelsRequest)    returns (CreateChannelsResponse)    {}
    rpc UpdateChannel     (UpdateChannelRequest)     returns (UpdateChannelResponse)     {}
    rpc GetChannel        (GetChannelRequest)        returns (GetChannelResponse)        {}
    rpc ExistChannel      (ExistChannelRequest)      returns (ExistChannelResponse)      {}
    rpc ExistChannelConds (ExistChannelCondsRequest) returns (ExistChannelCondsResponse) {}
    rpc DeleteChannel     (DeleteChannelRequest)     returns (DeleteChannelResponse)     {}
}

message Channel {
    string               ID        = 10;
    string               AppID     = 20;
    basetypes.v1.UsedFor EventType = 30;
    basetypes.v1.NotifChannel Channel = 40;
    uint32               CreatedAt = 50;
    uint32               UpdatedAt = 60;
}

message ChannelReq {
    optional string               ID        = 10;
    optional string               AppID     = 20;
    optional basetypes.v1.UsedFor EventType = 30;
    optional basetypes.v1.NotifChannel Channel = 40;
}

message Conds {
    optional basetypes.v1.StringVal      ID         = 10;
    optional basetypes.v1.StringVal      AppID      = 20;
    optional basetypes.v1.Uint32Val      EventType  = 30;
    optional basetypes.v1.Uint32Val      Channel    = 40;
    optional basetypes.v1.Uint32SliceVal EventTypes = 50;
    optional basetypes.v1.Uint32SliceVal Channels   = 60;
}

message GetChannelsRequest {
    Conds Conds   = 10;
    int32 Offset  = 20;
    int32 Limit   = 30;
}

message GetChannelsResponse {
    repeated Channel Infos = 10;
    uint32           Total = 20;
}

message GetChannelOnlyRequest {
    Conds Conds   = 10;
}

message GetChannelOnlyResponse {
    Channel Info = 10;
}

message CreateChannelRequest {
    ChannelReq Info = 10;
}

message CreateChannelResponse {
    Channel Info = 10;
}

message CreateChannelsRequest {
    repeated ChannelReq Infos = 10;
}

message CreateChannelsResponse {
    repeated Channel Infos = 10;
}

message UpdateChannelRequest {
    ChannelReq Info = 10;
}

message UpdateChannelResponse {
    Channel Info = 10;
}

message GetChannelRequest {
    string ID = 10;
}

message GetChannelResponse {
    Channel Info = 10;
}

message ExistChannelRequest {
    string ID = 10;
}

message ExistChannelResponse {
    bool Info = 10;
}

message ExistChannelCondsRequest {
    Conds Conds = 10;
}

message ExistChannelCondsResponse {
    bool Info = 10;
}

message DeleteChannelRequest {
    ChannelReq Info = 10;
}

message DeleteChannelResponse {
    Channel Info = 10;
}