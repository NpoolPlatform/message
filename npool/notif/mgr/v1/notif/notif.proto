syntax = "proto3";

package notif.manager.notif1.v1;

option go_package = "github.com/NpoolPlatform/message/npool/notif/mgr/v1/notif";

import "npool/notif/mgr/v1/channel/channel.proto";
import "npool/npool.proto";
import "npool/basetypes/v1/usedfor.proto";

// Service Name
service Manager {
    rpc CreateNotif     (CreateNotifRequest)     returns (CreateNotifResponse)     {}
    rpc CreateNotifs    (CreateNotifsRequest)    returns (CreateNotifsResponse)    {}
    rpc UpdateNotif     (UpdateNotifRequest)     returns (UpdateNotifResponse)     {}
    rpc GetNotif        (GetNotifRequest)        returns (GetNotifResponse)        {}
    rpc GetNotifOnly    (GetNotifOnlyRequest)    returns (GetNotifOnlyResponse)    {}
    rpc GetNotifs       (GetNotifsRequest)       returns (GetNotifsResponse)       {}
    rpc ExistNotif      (ExistNotifRequest)      returns (ExistNotifResponse)      {}
    rpc ExistNotifConds (ExistNotifCondsRequest) returns (ExistNotifCondsResponse) {}
    rpc CountNotifs     (CountNotifsRequest)     returns (CountNotifsResponse)     {}
    rpc DeleteNotif     (DeleteNotifRequest)     returns (DeleteNotifResponse)     {}
}

message NotifReq {
    optional string    ID          = 10;
    optional string    AppID       = 20;
    optional string    UserID      = 30;
    optional bool      Notified    = 40;
    optional string    LangID      = 50;
    optional basetypes.v1.UsedFor EventType = 60;
    optional bool      UseTemplate = 70;
    optional string    Title       = 80;
    optional string    Content     = 90;
    optional notif.manager.channel.v1.NotifChannel Channel = 100;
    optional string    Extra       = 110;
    optional string    EventID     = 120;
}

message Notif {
    string    ID          = 10;
    string    AppID       = 20;
    string    UserID      = 30;
    bool      Notified    = 40;
    string    LangID      = 50;
    basetypes.v1.UsedFor EventType = 60;
    bool      UseTemplate = 70;
    string    Title       = 80;
    string    Content     = 90;
    notif.manager.channel.v1.NotifChannel Channel = 100;
    string    Extra       = 110;
    uint32    CreatedAt   = 120;
    uint32    UpdatedAt   = 130;
    string    EventID     = 140;
}

message Conds {
    optional npool.v1.StringVal      ID          = 10;
    optional npool.v1.StringSliceVal IDs         = 11;
    optional npool.v1.StringVal      AppID       = 20;
    optional npool.v1.StringVal      UserID      = 30;
    optional npool.v1.BoolVal        Notified    = 40;
    optional npool.v1.StringVal      LangID      = 50;
    optional npool.v1.Uint32Val      EventType   = 60;
    optional npool.v1.BoolVal        UseTemplate = 70;
    optional npool.v1.Uint32SliceVal Channels    = 80;
    optional npool.v1.Uint32Val      Channel     = 90;
    optional npool.v1.Uint32SliceVal EventTypes  = 100;
    optional npool.v1.StringVal      Extra       = 110;
}


message CreateNotifRequest {
    NotifReq Info = 10;
}

message CreateNotifResponse {
    Notif Info = 10;
}

message CreateNotifsRequest {
    repeated NotifReq Infos = 10;
}

message CreateNotifsResponse {
    repeated Notif Infos = 10;
}

message UpdateNotifRequest {
    NotifReq Info = 10;
}

message UpdateNotifResponse {
    Notif Info = 10;
}

message GetNotifRequest {
    string ID = 10;
}

message GetNotifResponse {
    Notif Info = 10;
}

message GetNotifsRequest {
    Conds Conds   = 10;
    int32 Offset  = 20;
    int32 Limit   = 30;
}

message GetNotifsResponse {
    repeated Notif Infos = 10;
    uint32        Total = 20;
}

message GetNotifOnlyRequest {
    Conds Conds = 10;
}

message GetNotifOnlyResponse {
    Notif Info = 10;
}

message ExistNotifRequest {
    string ID = 10;
}

message ExistNotifResponse {
    bool Info = 10;
}

message ExistNotifCondsRequest {
    Conds Conds = 10;
}

message ExistNotifCondsResponse {
    bool Info = 10;
}

message CountNotifsRequest {
    Conds Conds = 10;
}

message CountNotifsResponse {
    uint32 Info = 10;
}

message DeleteNotifRequest {
    string ID = 10;
}

message DeleteNotifResponse {
    Notif Info = 10;
}
