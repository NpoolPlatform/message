syntax = "proto3";

package third.middleware.verify.v1;

option go_package = "github.com/NpoolPlatform/message/npool/third/mw/v1/verify";

import "npool/basetypes/v1/signmethod.proto";
import "npool/basetypes/v1/usedfor.proto";

service Middleware {
    rpc VerifyCode              (VerifyCodeRequest)              returns (VerifyCodeResponse)              {}
    rpc VerifyGoogleRecaptchaV3 (VerifyGoogleRecaptchaV3Request) returns (VerifyGoogleRecaptchaV3Response) {}
    rpc SendCode                (SendCodeRequest)                returns (SendCodeResponse)                {}
}

message VerifyCodeRequest {
    string                  AppID       = 10;
    //if AccountType is Google then Account is GoogleSecret
    string                  Account     = 20;
    basetypes.v1.SignMethod AccountType = 30;
    basetypes.v1.UsedFor    UsedFor     = 40;
    string                  Code        = 50;
}

message VerifyCodeResponse {
}

message SendCodeRequest {
    string                  AppID       = 10;
    string                  LangID      = 20;
    string                  Account     = 30;
    basetypes.v1.SignMethod AccountType = 40;
    basetypes.v1.UsedFor    UsedFor     = 50;
    optional string         ToUsername  = 60;
}

message SendCodeResponse {
}

message VerifyGoogleRecaptchaV3Request {
    string RecaptchaToken = 10;
}

message VerifyGoogleRecaptchaV3Response {

}
