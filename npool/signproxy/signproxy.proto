syntax = "proto3";

package sphinx.proxy.v1;

option go_package = "github.com/NpoolPlatform/message/npool/signproxy";

import "npool/sphinxplugin/sphinxplugin.proto";

// TODO 分开 sign 和 proxy 的队列
// Service Name
service SignProxy {
    rpc ProxyPluginChannel (stream ProxyPluginChannelResponse) returns (stream ProxyPluginChannelRequest) {}
    rpc Transaction (stream TransactionResponse) returns (stream TransactionRequest) {}
}

// message AccountInfo {
//     string SigType = 100;// secp256k1
//     string Address = 110;
// }

// message WalletNewResponse {
//     AccountInfo Info = 100;
// }

// RegisterCoin MpoolGetNonce MpoolPush WalletBalance ..
message ProxyPluginChannelRequest {
    sphinx.plugin.v1.CoinType CoinType = 100;
}

message ProxyPluginChannelResponse {

}

enum TransactionType {
    Invalid = 0;
    Signature = 1;
    WalletNew = 2;
}

message TransactionRequest {
    TransactionType TransactionType             = 100;
    sphinx.plugin.v1.CoinType CoinType          = 110;
    sphinx.plugin.v1.UnsignedMessage Message    = 120;
}

message TransactionResponse {
    TransactionResponseInfo Info = 100;
}

message TransactionResponseInfo {
    string Address                              = 100;// create new account address
    sphinx.plugin.v1.UnsignedMessage Message    = 110;
	sphinx.plugin.v1.Signature       Signature  = 120;
}

enum TransSM {
    TransSMInvalid = 0;
    TransSMPreSign = 1;
    TransSMSign = 2;
    TransSMBroadcast = 3;
}