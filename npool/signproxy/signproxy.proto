syntax = "proto3";

package sphinx.proxy.v1;

option go_package = "github.com/NpoolPlatform/message/npool/signproxy";

import "npool/sphinxplugin/sphinxplugin.proto";

// TODO 分开 sign 和 proxy 的队列
// Service Name
service SignProxy {
    rpc FromPluginToProxy (stream FromPluginToProxyResponse) returns (stream FromPluginToProxyRequest) {}
    rpc FromProxyToPlugin (stream FromProxyToPluginResponse) returns (stream FromProxyToPluginRequest) {}
    rpc Transaction (stream TransactionResponse) returns (stream TransactionRequest) {}
    //  get account balance
    // rpc WalletBalance (sphinx.plugin.v1.WalletBalanceRequest) returns (sphinx.plugin.v1.WalletBalanceResponse) {}
}

// message AccountInfo {
//     string SigType = 100;// secp256k1
//     string Address = 110;
// }

// message WalletNewResponse {
//     AccountInfo Info = 100;
// }

// RegisterCoin ..
message FromPluginToProxyResponse {
    sphinx.plugin.v1.CoinType CoinType = 100;
}

message FromPluginToProxyRequest {

}

// MpoolGetNonce MpoolPush WalletBalance ..
message FromProxyToPluginResponse {

}

message FromProxyToPluginRequest {

}

enum TransactionType {
    Invalid = 0;
    Signature = 1;
    WalletNew = 2;
}

message TransactionRequest {
    TransactionType TransactionType             = 100;
    sphinx.plugin.v1.CoinType CoinType          = 110;
    sphinx.plugin.v1.UnsignedMessage Message    = 120;
}

message TransactionResponse {
    TransactionResponseInfo Info = 100;
}

message TransactionResponseInfo {
    string Address                              = 100;// create new account address
    sphinx.plugin.v1.UnsignedMessage Message    = 110;
	sphinx.plugin.v1.Signature       Signature  = 120;
}
