syntax = "proto3";

package good.manager.good.v1;

option go_package = "github.com/NpoolPlatform/message/npool/good/mgr/v1/good";

import "google/api/annotations.proto";
import "google/protobuf/empty.proto";
import "npool/npool.proto";

// Service Name
service Manager {
    rpc CreateGood     (CreateGoodRequest)     returns (CreateGoodResponse)     {
        option (google.api.http) = {
            post: "/v1/mgr_good_app_CreateGood"
            body: "*"
        };
    }
    rpc CreateGoods    (CreateGoodsRequest)    returns (CreateGoodsResponse)    {
        option (google.api.http) = {
            post: "/v1/mgr_good_app_CreateGoods"
            body: "*"
        };
    }
    rpc UpdateGood     (UpdateGoodRequest)     returns (UpdateGoodResponse)     {
        option (google.api.http) = {
            post: "/v1/mgr_good_app_UpdateGood"
            body: "*"
        };
    }
    rpc GetGood        (GetGoodRequest)        returns (GetGoodResponse)        {
        option (google.api.http) = {
            post: "/v1/mgr_good_app_GetGood"
            body: "*"
        };
    }
    rpc GetGoodOnly    (GetGoodOnlyRequest)    returns (GetGoodOnlyResponse)    {
        option (google.api.http) = {
            post: "/v1/mgr_good_app_GetGoodOnly"
            body: "*"
        };
    }
    rpc GetGoods       (GetGoodsRequest)       returns (GetGoodsResponse)       {
        option (google.api.http) = {
            post: "/v1/mgr_good_app_GetGoods"
            body: "*"
        };
    }
    rpc ExistGood      (ExistGoodRequest)      returns (ExistGoodResponse)      {
        option (google.api.http) = {
            post: "/v1/mgr_good_app_ExistGood"
            body: "*"
        };
    }
    rpc ExistGoodConds (ExistGoodCondsRequest) returns (ExistGoodCondsResponse) {
        option (google.api.http) = {
            post: "/v1/mgr_good_app_ExistGoodConds"
            body: "*"
        };
    }
    rpc CountGoods     (CountGoodsRequest)     returns (CountGoodsResponse)     {
        option (google.api.http) = {
            post: "/v1/mgr_good_app_CountGoods"
            body: "*"
        };
    }
    rpc DeleteGood     (DeleteGoodRequest)     returns (DeleteGoodResponse)     {
        option (google.api.http) = {
            post: "/v1/mgr_good_app_DeleteGood"
            body: "*"
        };
    }
}

enum BenefitType {
    DefaultBenefitType   = 0;
    // Platform receive benefit, then distribute benefit to user
    BenefitTypePlatform  = 10;
    // User receive benefit from pool directly
    BenefitTypePool      = 20;
}

enum GoodType {
    DefaultGoodType         = 0;
    // Classic good: user pay for both device and other material, get all benefit
    GoodTypeClassicMining   = 10;
    // Union good: user pay for a part of material, get part of benefit
    GoodTypeUnionMining     = 20;

    // Fee good
    GoodTypeTechniqueFee    = 30;
    GoodTypeElectricityFee  = 40;
}

enum BenefitState {
    DefaultBenefitState    = 0;

    BenefitWait         = 10;
    BenefitTransferring = 20;
    BenefitBookKeeping  = 30;
}

message GoodReq {
    optional string        ID                 = 10;
    optional string        DeviceInfoID       = 20;
    optional int32         DurationDays       = 30;
    optional string        CoinTypeID         = 40;
    optional string        InheritFromGoodID  = 50;
    optional string        VendorLocationID   = 60;
    optional string        Price              = 70;
    optional BenefitType   BenefitType        = 80;
    optional GoodType      GoodType           = 90;
    optional string        Title              = 100;
    optional string        Unit               = 110;
    // For normal good, it's unit amount, or a percent
    optional int32         UnitAmount         = 120;
    // Except the main coin type mining, this device also support multiple coin type mining
    repeated string        SupportCoinTypeIDs = 130;
    optional uint32        DeliveryAt         = 140;
    optional uint32        StartAt            = 150;
    optional bool          TestOnly           = 160;
    optional uint32        BenefitIntervalHours = 170;
    optional BenefitState  BenefitState       = 180;
    repeated string        BenefitTIDs        = 190;
    optional string        NextBenefitStartAmount = 240;
    optional string        LastBenefitAmount  = 250;
}

message Good {
    string          ID                 = 10;
    string          DeviceInfoID       = 20;
    int32           DurationDays       = 30;
    string          CoinTypeID         = 40;
    string          InheritFromGoodID  = 50;
    string          VendorLocationID   = 60;
    string          Price              = 70;
    BenefitType     BenefitType        = 80;
    GoodType        GoodType           = 90;
    string          Title              = 100;
    string          Unit               = 110;
    int32           UnitAmount         = 120;
    repeated string SupportCoinTypeIDs = 130;
    uint32          DeliveryAt         = 140;
    uint32          StartAt            = 150;
    bool            TestOnly           = 160;
    uint32          CreatedAt          = 170;
    uint32          UpdatedAt          = 180;
    uint32          DeletedAt          = 190;
    uint32          BenefitIntervalHours = 200;
    BenefitState    BenefitState       = 210;
    uint32          LastBenefitAt      = 220;
    repeated string BenefitTIDs        = 230;
    string          NextBenefitStartAmount = 240;
    string          LastBenefitAmount  = 250;
}

message Conds {
    optional npool.v1.StringVal      ID               = 10;
    optional npool.v1.StringVal      DeviceInfoID     = 20;
    optional npool.v1.StringVal      CoinTypeID       = 30;
    optional npool.v1.StringVal      VendorLocationID = 40;
    optional npool.v1.Int32Val       BenefitType      = 50;
    optional npool.v1.Int32Val       GoodType         = 60;
    optional npool.v1.StringSliceVal IDs              = 70;
    optional npool.v1.Int32Val       BenefitState     = 80;
}


message CreateGoodRequest {
    GoodReq Info = 10;
}

message CreateGoodResponse {
    Good Info = 10;
}

message CreateGoodsRequest {
    repeated GoodReq Infos = 10;
}

message CreateGoodsResponse {
    repeated Good Infos = 10;
}

message UpdateGoodRequest {
    GoodReq Info = 10;
}

message UpdateGoodResponse {
    Good Info = 10;
}

message GetGoodRequest {
    string ID = 10;
}

message GetGoodResponse {
    Good Info = 10;
}

message GetGoodsRequest {
    Conds Conds   = 10;
    int32 Offset  = 20;
    int32 Limit   = 30;
}

message GetGoodsResponse {
    repeated Good Infos = 10;
    uint32        Total = 20;
}

message GetGoodOnlyRequest {
    Conds Conds = 10;
}

message GetGoodOnlyResponse {
    Good Info = 10;
}

message ExistGoodRequest {
    string ID = 10;
}

message ExistGoodResponse {
    bool Info = 10;
}

message ExistGoodCondsRequest {
    Conds Conds = 10;
}

message ExistGoodCondsResponse {
    bool Info = 10;
}

message CountGoodsRequest {
    Conds Conds = 10;
}

message CountGoodsResponse {
    uint32 Info = 10;
}

message DeleteGoodRequest {
    string ID = 10;
}

message DeleteGoodResponse {
    Good Info = 10;
}
