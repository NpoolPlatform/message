syntax = "proto3";

package cloud.hashing.apis.v1;

option go_package = "github.com/NpoolPlatform/message/npool/cloud-hashing-apis";

import "google/api/annotations.proto";
import "google/protobuf/empty.proto";

import "npool/npool.proto";
import "npool/cloud-hashing-goods/cloud-hashing-goods.proto";
import "npool/cloud-hashing-order/cloud-hashing-order.proto";
import "npool/cloud-hashing-billing/cloud-hashing-billing.proto";
import "npool/cloud-hashing-inspire/cloud-hashing-inspire.proto";
import "npool/kyc/kyc-management.proto";
import "npool/review-service/review-service.proto";
import "npool/appusermgr/appusermgr.proto";
import "npool/coininfo/coininfo.proto";

// Cloud Hashing Goods
service CloudHashingApis {
    rpc Version (google.protobuf.Empty) returns (npool.v1.VersionResponse){
        option (google.api.http) = {
            post: "/version"
            body: "*"
        };
    }

    rpc GetGoods (GetGoodsRequest) returns (GetGoodsResponse) {
        option (google.api.http) = {
            post: "/v1/get/goods"
            body: "*"
        };
    }
    rpc GetGoodsByApp (GetGoodsByAppRequest) returns (GetGoodsByAppResponse) {
        option (google.api.http) = {
            post: "/v1/get/goods/by/app"
            body: "*"
        };
    }
    rpc CreateGood (CreateGoodRequest) returns (CreateGoodResponse) {
        option (google.api.http) = {
            post: "/v1/create/good"
            body: "*"
        };
    }
    rpc GetGood (GetGoodRequest) returns (GetGoodResponse) {
        option (google.api.http) = {
            post: "/v1/get/good"
            body: "*"
        };
    }
    rpc GetRecommendGoodsByApp (GetRecommendGoodsByAppRequest) returns (GetRecommendGoodsByAppResponse) {
        option (google.api.http) = {
            post: "/v1/get/recommend/goods/by/app"
            body: "*"
        };
    }

    rpc SubmitOrder (SubmitOrderRequest) returns (SubmitOrderResponse) {
        option (google.api.http) = {
            post: "/v1/submit/order"
            body: "*"
        };
    }
    rpc CreateOrderPayment (CreateOrderPaymentRequest) returns (CreateOrderPaymentResponse) {
        option (google.api.http) = {
            post: "/v1/create/order/payment"
            body: "*"
        };
    }

    rpc GetOrder (GetOrderRequest) returns (GetOrderResponse) {
        option (google.api.http) = {
            post: "/v1/get/order"
            body: "*"
        };
    }

    rpc GetOrdersByAppUser (GetOrdersByAppUserRequest) returns (GetOrdersByAppUserResponse) {
        option (google.api.http) = {
            post: "/v1/get/orders/by/app/user"
            body: "*"
        };
    }
    rpc GetOrdersByApp (GetOrdersByAppRequest) returns (GetOrdersByAppResponse) {
        option (google.api.http) = {
            post: "/v1/get/orders/by/app"
            body: "*"
        };
    }
    rpc GetOrdersByGood (GetOrdersByGoodRequest) returns (GetOrdersByGoodResponse) {
        option (google.api.http) = {
            post: "/v1/get/orders/by/good"
            body: "*"
        };
    }

    rpc Signup (SignupRequest) returns (SignupResponse) {
        option (google.api.http) = {
            post: "/v1/signup"
            body: "*"
        };
    }
    rpc UpdatePassword (UpdatePasswordRequest) returns (UpdatePasswordResponse) {
        option (google.api.http) = {
            post: "/v1/update/password"
            body: "*"
        };
    }
    rpc UpdatePasswordByAppUser (UpdatePasswordByAppUserRequest) returns (UpdatePasswordByAppUserResponse) {
        option (google.api.http) = {
            post: "/v1/update/password/by/app/user"
            body: "*"
        };
    }
    rpc UpdateEmailAddress (UpdateEmailAddressRequest) returns (UpdateEmailAddressResponse) {
        option (google.api.http) = {
            post: "/v1/update/emailaddress"
            body: "*"
        };
    }
    rpc UpdatePhoneNO (UpdatePhoneNORequest) returns (UpdatePhoneNOResponse) {
        option (google.api.http) = {
            post: "/v1/update/phoneno"
            body: "*"
        };
    }

    rpc GetMyInvitations (GetMyInvitationsRequest) returns (GetMyInvitationsResponse) {
        option (google.api.http) = {
            post: "/v1/get/my/invitations"
            body: "*"
        };
    }
    rpc GetMyDirectInvitations (GetMyDirectInvitationsRequest) returns (GetMyDirectInvitationsResponse) {
        option (google.api.http) = {
            post: "/v1/get/my/direct/invitations"
            body: "*"
        };
    }

    rpc GetReferrals (GetReferralsRequest) returns (GetReferralsResponse) {
        option (google.api.http) = {
            post: "/v1/get/referrals",
            body: "*"
        };
    }
    rpc GetLayeredReferrals (GetLayeredReferralsRequest) returns (GetLayeredReferralsResponse) {
        option (google.api.http) = {
            post: "/v1/get/layered/referrals"
            body: "*"
        };
    }

    rpc GetKycReviews (GetKycReviewsRequest) returns (GetKycReviewsResponse) {
        option (google.api.http) = {
            post: "/v1/get/kyc/reviews"
            body: "*"
        };
    }
    rpc GetKycReviewsByApp (GetKycReviewsByAppRequest) returns (GetKycReviewsByAppResponse) {
        option (google.api.http) = {
            post: "/v1/get/kyc/reviews/by/app"
            body: "*"
        };
    }
    rpc GetKycReviewsByOtherApp (GetKycReviewsByOtherAppRequest) returns (GetKycReviewsByOtherAppResponse) {
        option (google.api.http) = {
            post: "/v1/get/kyc/reviews/by/other/app"
            body: "*"
        };
    }
    rpc GetGoodReviews (GetGoodReviewsRequest) returns (GetGoodReviewsResponse) {
        option (google.api.http) = {
            post: "/v1/get/good/reviews"
            body: "*"
        };
    }
    rpc GetWithdrawReviews (GetWithdrawReviewsRequest) returns (GetWithdrawReviewsResponse) {
        option (google.api.http) = {
            post: "/v1/get/withdraw/reviews"
            body: "*"
        };
    }
    rpc GetWithdrawReviewsByApp (GetWithdrawReviewsByAppRequest) returns (GetWithdrawReviewsByAppResponse) {
        option (google.api.http) = {
            post: "/v1/get/withdraw/reviews/by/app"
            body: "*"
        };
    }
    rpc GetWithdrawReviewsByOtherApp (GetWithdrawReviewsByOtherAppRequest) returns (GetWithdrawReviewsByOtherAppResponse) {
        option (google.api.http) = {
            post: "/v1/get/withdraw/reviews/by/other/app"
            body: "*"
        };
    }
    rpc GetWithdrawAddressReviews (GetWithdrawAddressReviewsRequest) returns (GetWithdrawAddressReviewsResponse) {
        option (google.api.http) = {
            post: "/v1/get/withdraw/address/reviews"
            body: "*"
        };
    }
    rpc GetWithdrawAddressReviewsByApp (GetWithdrawAddressReviewsByAppRequest) returns (GetWithdrawAddressReviewsByAppResponse) {
        option (google.api.http) = {
            post: "/v1/get/withdraw/address/reviews/by/app"
            body: "*"
        };
    }
    rpc GetWithdrawAddressReviewsByOtherApp (GetWithdrawAddressReviewsByOtherAppRequest) returns (GetWithdrawAddressReviewsByOtherAppResponse) {
        option (google.api.http) = {
            post: "/v1/get/withdraw/address/reviews/by/other/app"
            body: "*"
        };
    }

    rpc CreateKyc (CreateKycRequest) returns (CreateKycResponse) {
        option (google.api.http) = {
            post: "/v1/create/kyc"
            body: "*"
        };
    }
    rpc UpdateKyc (UpdateKycRequest) returns (UpdateKycResponse) {
        option (google.api.http) = {
            post: "/v1/update/kyc"
            body: "*"
        };
    }
    rpc GetKycByAppUser(GetKycByAppUserRequest) returns (GetKycByAppUserResponse) {
        option (google.api.http) = {
            post: "/v1/get/kyc/by/app/user"
            body: "*"
        };
    }

    rpc CreatePlatformCoinAccount (CreatePlatformCoinAccountRequest) returns (CreatePlatformCoinAccountResponse) {
        option (google.api.http) = {
            post: "/v1/create/platform/coin/account"
            body: "*"
        };
    }
    rpc CreateUserCoinAccount (CreateUserCoinAccountRequest) returns (CreateUserCoinAccountResponse) {
        option (google.api.http) = {
            post: "/v1/create/user/coin/account"
            body: "*"
        };
    }

    rpc SubmitUserWithdraw (SubmitUserWithdrawRequest) returns (SubmitUserWithdrawResponse) {
        option (google.api.http) = {
            post: "/v1/submit/user/withdraw"
            body: "*"
        };
    }
    rpc UpdateUserWithdrawReview (UpdateUserWithdrawReviewRequest) returns (UpdateUserWithdrawReviewResponse) {
        option (google.api.http) = {
            post: "/v1/update/user/withdraw/review"
            body: "*"
        };
    }
    rpc UpdateUserWithdrawReviewForOtherAppUser (UpdateUserWithdrawReviewForOtherAppUserRequest) returns (UpdateUserWithdrawReviewForOtherAppUserResponse) {
        option (google.api.http) = {
            post: "/v1/update/user/withdraw/review/for/other/app"
            body: "*"
        };
    }
    rpc GetUserWithdrawsByAppUser (GetUserWithdrawsByAppUserRequest) returns (GetUserWithdrawsByAppUserResponse) {
        option (google.api.http) = {
            post: "/v1/get/user/withdraws/by/app/user"
            body: "*"
        };
    }

    rpc SetWithdrawAddress (SetWithdrawAddressRequest) returns (SetWithdrawAddressResponse) {
        option (google.api.http) = {
            post: "/v1/set/withdraw/address"
            body: "*"
        };
    }
    rpc GetWithdrawAddressesByAppUser (GetWithdrawAddressesByAppUserRequest) returns (GetWithdrawAddressesByAppUserResponse) {
        option (google.api.http) = {
            post: "/v1/get/withdraw/addresses/by/app/user"
            body: "*"
        };
    }

    rpc GetCouponsByAppUser (GetCouponsByAppUserRequest) returns (GetCouponsByAppUserResponse) {
        option (google.api.http) = {
            post: "/v1/get/coupons/by/app/user"
            body: "*"
        };
    }

    rpc GetCommissionByAppUser (GetCommissionByAppUserRequest) returns (GetCommissionByAppUserResponse) {
        option (google.api.http) = {
            post: "/v1/get/commission/by/app/user"
            body: "*"
        };
    }

    rpc UpdateKycReview(UpdateKycReviewRequest) returns (UpdateKycReviewResponse) {
        option (google.api.http) = {
            post: "/v1/update/kyc/review"
            body: "*"
        };
    }
}

// Request body and response
message Good {
    cloud.hashing.goods.v1.GoodDetail Good = 10;
    sphinx.coininfo.v1.CoinInfo Main = 20;
    repeated sphinx.coininfo.v1.CoinInfo SupportCoins = 30;
    repeated review.service.v1.Review Reviews = 40;
    uint32 Sold = 50;
}

message RecommendGood {
    Good Good = 10;
    cloud.hashing.goods.v1.Recommend Recommend = 20;
}

message CreateGoodRequest {
    cloud.hashing.goods.v1.GoodInfo Info = 10;
}

message CreateGoodResponse {
    Good Info = 10;
}

message GetGoodRequest {
    string ID = 10;
}

message GetGoodResponse {
    Good Info = 10;
}

message GetGoodsRequest {
    npool.v1.PageInfo PageInfo = 10;
}

message GetGoodsResponse {
    repeated Good Infos = 10;
    int32 Total = 20;
}

message GetGoodsByAppRequest {
    string AppID = 10;
    npool.v1.PageInfo PageInfo = 20;
}

message GetGoodsByAppResponse {
    repeated Good Infos = 10;
    int32 Total = 20;
}

message GetRecommendGoodsByAppRequest {
    string AppID = 10;
}

message GetRecommendGoodsByAppResponse {
    repeated RecommendGood Infos = 10;
}

message Order {
    cloud.hashing.order.v1.OrderDetail Order = 10;
    cloud.hashing.billing.v1.CoinAccountInfo PayToAccount = 20;
    Good Good = 30;
    sphinx.coininfo.v1.CoinInfo PayWithCoin = 40;
    cloud.hashing.inspire.v1.CouponAllocatedDetail FixAmountCoupon = 50;
    cloud.hashing.inspire.v1.CouponAllocatedDetail DiscountCoupon = 60;
    cloud.hashing.inspire.v1.UserSpecialReduction UserSpecialReduction = 70;
    uint32 PaymentDeadline = 80;
    cloud.hashing.goods.v1.AppGoodInfo AppGood = 90;
    cloud.hashing.goods.v1.AppGoodPromotion Promotion = 100;
}

message GetOrderRequest {
    string ID = 10;
}

message GetOrderResponse {
    Order Info = 10;
}

message GetOrdersByAppUserRequest {
    string AppID = 10;
    string UserID = 20;
}

message GetOrdersByAppUserResponse {
    repeated Order Infos = 10;
}

message GetOrdersByAppRequest {
    string AppID = 10;
}

message GetOrdersByAppResponse {
    repeated Order Infos = 10;
}

message GetOrdersByGoodRequest {
    string GoodID = 10;
}

message GetOrdersByGoodResponse {
    repeated Order Infos = 10;
}

message OrderFee {
    string ID = 10;
    uint32 DurationDays = 20;
}

message SubmitOrderRequest {
    string GoodID = 10;
    uint32 Units = 20;
    string UserID = 30;
    string AppID = 40;
    string CouponID = 50;
    string DiscountCouponID = 60;
    string UserSpecialReductionID = 70;
}

message SubmitOrderResponse {
    Order Info = 10;
}

message CreateOrderPaymentRequest {
    string OrderID = 10;
    string PaymentCoinTypeID = 20;
    repeated OrderFee Fees = 30;
}

message CreateOrderPaymentResponse {
    Order Info = 10;
}

message SignupRequest {
    string Username = 10;
    string PasswordHash = 20;
    string Account = 30;
    string AccountType = 40;
    string VerificationCode = 50;
    string AppID = 60;
    string InvitationCode = 70;
}

message SignupResponse {
    app.user.manager.v1.AppUser Info = 10;
}

message UpdatePasswordRequest {
    string AppID = 10;
    string Account = 20;
    string AccountType = 30;
    string PasswordHash = 40;
    string VerificationCode = 50;
}

message UpdatePasswordResponse {
    app.user.manager.v1.AppUserSecret Info = 10;
}

message UpdatePasswordByAppUserRequest {
    string AppID = 10;
    string UserID = 20;
    string Account = 30;
    string AccountType = 40;
    string OldPasswordHash = 50;
    string PasswordHash = 60;
    string VerificationCode = 70;
}

message UpdatePasswordByAppUserResponse {
    app.user.manager.v1.AppUserSecret Info = 10;
}

message UpdateEmailAddressRequest {
    string AppID = 10;
    string UserID = 20;
    string OldVerificationCode = 30;
    string OldAccount = 40;
    string OldAccountType = 50;
    string NewEmailAddress = 60;
    string NewEmailVerificationCode = 70;
}

message UpdateEmailAddressResponse {
    app.user.manager.v1.AppUserInfo Info = 10;
}

message UpdatePhoneNORequest {
    string AppID = 10;
    string UserID = 20;
    string OldVerificationCode = 30;
    string OldAccount = 40;
    string OldAccountType = 50;
    string NewPhoneNO = 60;
    string NewPhoneVerificationCode = 70;
}

message UpdatePhoneNOResponse {
    app.user.manager.v1.AppUserInfo Info = 10;
}

message InvitationSummary {
    uint32 Units = 10;
    double Amount = 20;
}

message CommissionAmount {
    uint32 Start = 10;
    uint32 End = 20;
    uint32 Percent = 30;
    double Amount = 40;
    double PayAmount = 50;
    uint32 CreateAt = 60;
}

message InvitationUserInfo {
    string UserID = 10;
    string Username = 20;
    string Avatar = 30;
    string EmailAddress = 40;
    bool Kol = 50;
    map<string, InvitationSummary> Summarys = 60;
    map<string, InvitationSummary> MySummarys = 70;
    uint32 InvitedCount = 80;
    uint32 JoinDate = 90;
    repeated CommissionAmount MyCommissions = 100;
    repeated CommissionAmount Commissions = 110;
    double CommissionAmount = 120;
}

message Invitation {
    repeated InvitationUserInfo Invitees = 10;
}

message GetMyInvitationsRequest {
    string AppID = 10;
    string UserID = 20;
}

message GetMyInvitationsResponse {
    InvitationUserInfo MySelf = 10;
    map<string, Invitation> Infos = 20;
}

message GetMyDirectInvitationsRequest {
    string AppID = 10;
    string UserID = 20;
}

message GetMyDirectInvitationsResponse {
    InvitationUserInfo MySelf = 10;
    map<string, Invitation> Infos = 20;
}

message Referral {
    app.user.manager.v1.AppUser User = 10;
    app.user.manager.v1.AppUserExtra Extra = 20;
    cloud.hashing.inspire.v1.RegistrationInvitation Invitation = 30;
    double USDAmount = 40;
    double SubUSDAmount = 50;
    bool Kol = 60;
}

message GetReferralsRequest {
    string AppID = 10;
    string UserID = 20;
}

message GetReferralsResponse {
    repeated Referral Infos = 10;
}

message GetLayeredReferralsRequest {
    string AppID = 10;
    string UserID = 20;
}

message GetLayeredReferralsResponse {
    repeated Referral Infos = 10;
}

message KycReview {
    review.service.v1.Review Review = 10;
    app.user.manager.v1.AppUserInfo User = 20;
    kyc.management.v1.KycInfo Kyc = 30;
}

message GetKycReviewsRequest {
    string AppID = 10;
}

message GetKycReviewsResponse {
    repeated  KycReview Infos = 10;
}

message GetKycReviewsByAppRequest {
    string AppID = 10;
}

message GetKycReviewsByAppResponse {
    repeated  KycReview Infos = 10;
}

message GetKycReviewsByOtherAppRequest {
    string TargetAppID = 10;
}

message GetKycReviewsByOtherAppResponse {
    repeated  KycReview Infos = 10;
}

message GoodReview {
    review.service.v1.Review Review = 10;
    app.user.manager.v1.AppUserInfo CreatedBy = 20;
    cloud.hashing.goods.v1.GoodDetail Good = 30;
}

message GetGoodReviewsRequest {
}

message GetGoodReviewsResponse {
    repeated GoodReview Infos = 10;
}

message Kyc {
    kyc.management.v1.KycInfo Kyc = 10;
    string State = 20;
    string Message = 30;
}

message GetKycByAppUserRequest {
    string AppID = 10;
    string UserID = 20;
}

message GetKycByAppUserResponse {
    Kyc Info = 10;
}

message CreateKycRequest {
    kyc.management.v1.KycInfo Info = 10;
}

message CreateKycResponse {
    Kyc Info = 10;
}

message UpdateKycRequest {
    kyc.management.v1.KycInfo Info = 30;
}

message UpdateKycResponse {
    Kyc Info = 10;
}

message CreatePlatformCoinAccountRequest {
    string CoinTypeID = 10;
}

message CreatePlatformCoinAccountResponse {
    cloud.hashing.billing.v1.CoinAccountInfo Info = 10;
}

message CreateUserCoinAccountRequest {
    cloud.hashing.billing.v1.CoinAccountInfo Info = 10;
}

message CreateUserCoinAccountResponse {
    cloud.hashing.billing.v1.CoinAccountInfo Info = 10;
}

message SubmitUserWithdrawRequest {
    cloud.hashing.billing.v1.UserWithdrawItem Info = 10;
    string Account = 20;
    string AccountType = 30;
    string VerificationCode = 40;
    string WithdrawType = 50;
}

message UserWithdraw {
    cloud.hashing.billing.v1.UserWithdrawItem Withdraw = 10;
    string State = 20;
    string Message = 30;
}

message WithdrawReview {
    review.service.v1.Review Review = 10;
    app.user.manager.v1.AppUserInfo User = 20;
    cloud.hashing.billing.v1.UserWithdrawItem Withdraw = 30;
}


message SubmitUserWithdrawResponse {
    UserWithdraw Info = 10;
}

message UpdateUserWithdrawReviewRequest {
    // Reviewer
    string AppID = 10;
    string UserID = 20;
    review.service.v1.Review Info = 30;
}

message UpdateUserWithdrawReviewResponse {
    WithdrawReview Info = 10;
}

message UpdateUserWithdrawReviewForOtherAppUserRequest {
    // Reviewer
    string AppID = 10;
    string UserID = 20;
    // Target
    string TargetAppID = 30;
    review.service.v1.Review Info = 40;
}

message UpdateUserWithdrawReviewForOtherAppUserResponse {
    WithdrawReview Info = 10;
}

message GetUserWithdrawsByAppUserRequest {
    string AppID = 10;
    string UserID = 20;
}

message GetUserWithdrawsByAppUserResponse {
    repeated UserWithdraw Infos = 10;
}

message GetWithdrawReviewsRequest {
    string AppID = 10;
}

message GetWithdrawReviewsResponse {
    repeated WithdrawReview Infos = 10;
}

message GetWithdrawReviewsByAppRequest {
    string AppID = 10;
}

message GetWithdrawReviewsByAppResponse {
    repeated WithdrawReview Infos = 10;
}

message GetWithdrawReviewsByOtherAppRequest {
    string TargetAppID = 10;
}

message GetWithdrawReviewsByOtherAppResponse {
    repeated WithdrawReview Infos = 10;
}

message WithdrawAddress {
    cloud.hashing.billing.v1.UserWithdraw Address = 10;
    string State = 20;
    string Message = 30;
    cloud.hashing.billing.v1.CoinAccountInfo Account = 40;
}

message SetWithdrawAddressRequest {
    string AppID = 10;
    string UserID = 20;
    string CoinTypeID = 30;
    string Address = 40;
    string Name = 50;
    string Message = 60;
    string Account = 70;
    string AccountType = 80;
    string VerificationCode = 90;
    repeated string Labels = 100;
}

message SetWithdrawAddressResponse {
    WithdrawAddress Info = 10;
}

message GetWithdrawAddressesByAppUserRequest {
    string AppID = 10;
    string UserID = 20;
}

message GetWithdrawAddressesByAppUserResponse {
    repeated WithdrawAddress Infos = 10;
}

message WithdrawAddressReview {
    review.service.v1.Review Review = 10;
    app.user.manager.v1.AppUserInfo User = 20;
    cloud.hashing.billing.v1.UserWithdraw Address = 30;
    cloud.hashing.billing.v1.CoinAccountInfo Account = 40;
}

message GetWithdrawAddressReviewsRequest {
    string AppID = 10;
}

message GetWithdrawAddressReviewsResponse {
    repeated WithdrawAddressReview Infos = 10;
}

message GetWithdrawAddressReviewsByAppRequest {
    string AppID = 10;
}

message GetWithdrawAddressReviewsByAppResponse {
    repeated WithdrawAddressReview Infos = 10;
}

message GetWithdrawAddressReviewsByOtherAppRequest {
    string TargetAppID = 10;
}

message GetWithdrawAddressReviewsByOtherAppResponse {
    repeated WithdrawAddressReview Infos = 10;
}


message Coupon {
    cloud.hashing.inspire.v1.CouponAllocatedDetail Coupon = 10;
    cloud.hashing.order.v1.Order Order = 20;
}

message UserSpecial {
    cloud.hashing.inspire.v1.UserSpecialReduction Coupon = 10;
    cloud.hashing.order.v1.Order Order = 20;
}

message Coupons {
    repeated Coupon Coupons = 10;
    repeated UserSpecial Offers = 20;
}

message GetCouponsByAppUserRequest {
    string AppID = 10;
    string UserID = 20;
}

message GetCouponsByAppUserResponse {
    Coupons Info = 10;
}

message Commission {
    double Total = 10;
    double Balance = 20;
}

message GetCommissionByAppUserRequest {
    string AppID = 10;
    string UserID = 20;
}

message GetCommissionByAppUserResponse {
    Commission Info = 10;
}

message UpdateKycReviewRequest {
    review.service.v1.UpdateReviewRequest Review = 10;
}

message UpdateKycReviewResponse {
    review.service.v1.UpdateReviewResponse Info = 10;
}