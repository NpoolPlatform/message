syntax = "proto3";

package appuser.middleware.authing.auth.v1;

option go_package = "github.com/NpoolPlatform/message/npool/appuser/mw/v1/authing/auth";

import "google/api/annotations.proto";
import "google/protobuf/empty.proto";
import "npool/basetypes/v1/conds.proto";

service Middleware {
    rpc CreateAuth    (CreateAuthRequest)   returns (CreateAuthResponse)   {}
    rpc UpdateAuth    (UpdateAuthRequest)   returns (UpdateAuthResponse)   {}
    rpc ExistAuth     (ExistAuthRequest)    returns (ExistAuthResponse)    {}
    rpc GetAuth       (GetAuthRequest)      returns (GetAuthResponse)      {}
    rpc GetAuths      (GetAuthsRequest)     returns (GetAuthsResponse)     {}
    rpc DeleteAuth    (DeleteAuthRequest)   returns (DeleteAuthResponse)   {}
}

message AuthReq {
    optional string ID          = 10;
    optional string AppID       = 20;
    optional string RoleID      = 30;
    optional string UserID      = 40;
    optional string Resource    = 50;
    optional string Method      = 60;
}

message Auth {
    // @inject_tag: sql:"id"
    string ID           = 5;
    // @inject_tag: sql:"app_id"
    string AppID        = 10;
    // @inject_tag: sql:"app_name"
    string AppName      = 20;
    // @inject_tag: sql:"app_logo"
    string AppLogo      = 30;
    // @inject_tag: sql:"role_id"
    string RoleID       = 40;
    // @inject_tag: sql:"role_name"
    string RoleName     = 50;
    // @inject_tag: sql:"user_id"
    string UserID       = 60;
    // @inject_tag: sql:"email_address"
    string EmailAddress = 70;
    // @inject_tag: sql:"phone_no"
    string PhoneNO      = 80;
    // @inject_tag: sql:"resource"
    string Resource     = 90;
    // @inject_tag: sql:"method"
    string Method       = 100;
    // @inject_tag: sql:"created_at"
    uint32 CreatedAt    = 110;
}

message Conds {
    basetypes.v1.StringVal ID        = 10;
    basetypes.v1.StringVal AppID     = 20;
    basetypes.v1.StringVal RoleID    = 30;
    basetypes.v1.StringVal UserID    = 40;
    basetypes.v1.StringVal Resource  = 50;
    basetypes.v1.StringVal Method    = 60;
}

message CreateAuthRequest {
    AuthReq Info = 10;
}

message CreateAuthResponse {
    Auth Info = 10;
}

message UpdateAuthRequest {
    AuthReq Info = 10;
}

message UpdateAuthResponse {
    Auth Info = 10;
}

message ExistAuthRequest {
    string          AppID    = 10;
    optional string UserID   = 20;
    string          Resource = 30;
    string          Method   = 40;
}

message ExistAuthResponse {
    bool Info = 10;
}

message GetAuthRequest {
    string ID    = 10;
}

message GetAuthResponse {
    Auth Info = 10;
}

message GetAuthsRequest {
    string AppID    = 10;
    int32  Offset   = 20;
    int32  Limit    = 30;
}

message GetAuthsResponse {
    repeated Auth Infos = 10;
    uint32        Total = 20;
}

message DeleteAuthRequest {
    AuthReq Info = 10;
}

message DeleteAuthResponse {
    Auth Info = 10;
}


