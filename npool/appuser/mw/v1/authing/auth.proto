syntax = "proto3";

package appuser.middleware.authing.v1;

option go_package = "github.com/NpoolPlatform/message/npool/appuser/mw/v1/authing";

import "google/api/annotations.proto";
import "google/protobuf/empty.proto";
import "npool/npool.proto";

service Middleware {
    rpc ExistAuth     (ExistAuthRequest)    returns (ExistAuthResponse)    {}
    rpc GetAuths      (GetAuthsRequest)     returns (GetAuthsResponse)     {}
    rpc GetHistories  (GetHistoriesRequest) returns (GetHistoriesResponse) {}
}

message Auth {
    // @inject_tag: sql:"app_id"
    string AppID        = 10;
    // @inject_tag: sql:"app_name"
    string AppName      = 20;
    // @inject_tag: sql:"app_logo"
    string AppLogo      = 30;
    // @inject_tag: sql:"role_id"
    string RoleID       = 40;
    // @inject_tag: sql:"role_name"
    string RoleName     = 50;
    // @inject_tag: sql:"user_id"
    string UserID       = 60;
    // @inject_tag: sql:"email_address"
    string EmailAddress = 70;
    // @inject_tag: sql:"phone_no"
    string PhoneNO      = 80;
    // @inject_tag: sql:"resource"
    string Resource     = 90;
    // @inject_tag: sql:"method"
    string Method       = 100;
    // @inject_tag: sql:"created_at"
    uint32 CreatedAt    = 110;
}

message ExistAuthRequest {
    string          AppID    = 10;
    optional string UserID   = 20;
    string          Resource = 30;
    string          Method   = 40;
}

message ExistAuthResponse {
    bool Info = 10;
}


message GetAuthsRequest {
    string AppID    = 10;
    int32  Offset   = 20;
    int32  Limit    = 30;
}

message GetAuthsResponse {
    repeated Auth Infos = 10;
    uint32        Total = 20;
}

message History {
    // @inject_tag: sql:"app_id"
    string AppID        = 10;
    // @inject_tag: sql:"app_name"
    string AppName      = 20;
    // @inject_tag: sql:"app_logo"
    string AppLogo      = 30;
    // @inject_tag: sql:"user_id"
    string UserID       = 40;
    // @inject_tag: sql:"email_address"
    string EmailAddress = 50;
    // @inject_tag: sql:"phone_no"
    string PhoneNO      = 60;
    // @inject_tag: sql:"resource"
    string Resource     = 70;
    // @inject_tag: sql:"method"
    string Method       = 80;
    // @inject_tag: sql:"allowed"
    bool   Allowed      = 90;
    // @inject_tag: sql:"created_at"
    uint32 CreatedAt    = 100;
}

message GetHistoriesRequest {
    string AppID    = 10;
    int32  Offset   = 20;
    int32  Limit    = 30;
}

message GetHistoriesResponse {
    repeated History Infos = 10;
    uint32           Total = 20;
}

