syntax = "proto3";

package smoketest.gateway.testplan.v1;

option go_package = "github.com/NpoolPlatform/message/npool/smoketest/gw/v1/testplan";

import "npool/smoketest/mgr/v1/testplan/testplan.proto";
import "npool/smoketest/gw/v1/planrelatedtestcase/planrelatedtestcase.proto";
import "google/api/annotations.proto";

// Service Name
service Gateway {
    rpc GetTestPlans (GetTestPlansRequest) returns (GetTestPlansResponse) {
        option (google.api.http) = {
            post: "/v1/get/testplans"
            body: "*"
        };
    }

    rpc CreateTestPlan (CreateTestPlanRequest) returns (CreateTestPlanResponse) {
        option (google.api.http) = {
            post: "/v1/create/testplan"
            body: "*"
        };
    }

    rpc UpdateTestPlan (UpdateTestPlanRequest) returns (UpdateTestPlanResponse) {
        option (google.api.http) = {
            post: "/v1/update/testplan"
            body: "*"
        };
    }

    rpc DeleteTestPlan (DeleteTestPlanRequest) returns (DeleteTestPlanResponse) {
        option (google.api.http) = {
            post: "/v1/delete/testplan"
            body: "*"
        };
    }
}

message TestPlan {
    string          ID                                         = 10;
    string          Name                                       = 20;
    smoketest.manager.testplan.v1.TestPlanState   State        = 30; 
    string          OwnerID                                    = 40;
    string          OwnerName                                  = 50;
    string          ResponsibleUserID                          = 60;
    string          ResponsibleUsername                        = 70;
    uint32          FailedTestCasesCount                       = 80;
    uint32          PassedTestCasesCount                       = 90;
    uint32          SkippedTestCasesCount                      = 100;
    uint32          RunDuration                                = 110;
    smoketest.manager.testplan.v1.TestResultState TestResult   = 120;
    uint32          Deadline                                   = 130;
    uint32          CreatedAt                                  = 140;
    uint32          UpdatedAt                                  = 150;
    repeated smoketest.gateway.planrelatedtestcase.v1.PlanRelatedTestCase PlanRelatedTestCases  = 160;
}

message DeleteTestPlanRequest {
    string ID        = 10;
}

message DeleteTestPlanResponse {
    TestPlan Info = 10;
}

message GetTestPlansRequest {
    int32  Offset = 20;
    int32  Limit  = 30;
}

message GetTestPlansResponse {
    repeated TestPlan Infos = 10;
    uint32        Total   = 20;
}

message UpdateTestPlanRequest {
    string          ID                  = 10;
    string          Name                = 20;
    string          ResponsibleUserID   = 30;
    uint32          Deadline            = 40;
}

message UpdateTestPlanResponse {
    TestPlan Info = 10;
}

message CreateTestPlanRequest {
    string          Name                = 10;
    string          OwnerID             = 20;
    optional string          ResponsibleUserID   = 30;
    optional uint32          Deadline            = 40;
}

message CreateTestPlanResponse {
    TestPlan Info = 10;
}