syntax = "proto3";

package api.manager.v1;

option go_package = "github.com/NpoolPlatform/message/npool/apimgr";

import "google/api/annotations.proto";
import "google/protobuf/empty.proto";
import "npool/npool.proto";

service ApiManager {
    rpc Version (google.protobuf.Empty) returns (npool.v1.VersionResponse){
        option (google.api.http) = {
            post: "/version"
            body: "*"
        };
    }

    rpc Register(RegisterRequest) returns (RegisterResponse) {
        option (google.api.http) = {
            post: "/v1/register"
            body: "*"
        };
    }
    rpc GetApis(GetApisRequest) returns (GetApisResponse) {
        option (google.api.http) = {
            post: "/v1/get/apis"
            body: "*"
        };
    }
}

message Path {
    string Method = 10;
    string Path = 20;
    bool Exported = 30;
}

message ServiceApis {
    string ServiceName = 10;
    string PathPrefix = 20;
    repeated Path Paths = 30;
}

message RegisterRequest {
    ServiceApis Info = 10;
}

message RegisterResponse {
    ServiceApis Info = 10;
}

message ServicePath {
    string ServiceName = 10;
    string PathPrefix = 20;
    string Method = 30;
    string Path = 40;
    bool Exported = 50;
    uint32 CreateAt = 60;
    uint32 UpdateAt = 70;
}

message GetApisRequest {
}

message GetApisResponse {
    repeated ServicePath Infos = 10;
}
